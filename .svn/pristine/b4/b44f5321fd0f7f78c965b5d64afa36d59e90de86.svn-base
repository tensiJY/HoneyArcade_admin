package honeyarcade.admin.ad.coupon;

import java.util.List;
import java.util.Locale;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.MessageSource;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

import honeyarcade.admin.ad.build.AdminAdBuildVO;
import honeyarcade.admin.common.file.CommonFileService;
import honeyarcade.admin.util.SessionUtil;

@Service
public class AdminAdCouponService {

	@Autowired
	private AdminAdCouponMapper adminAdCouponMapper;
	
    @Autowired
    private MessageSource messageSource;
    
    @Autowired
    private CommonFileService commonFileService;
	
    /**
     * 쿠폰 관리 - 목록 : 쿠폰 전체 갯수 조회
     * @param adminAdAreaVO
     * @return
     * @throws Exception
     */
	public int getTotalCount(AdminAdCouponVO adminAdAreaVO) throws Exception{
		
		return adminAdCouponMapper.getTotalCount(adminAdAreaVO);
	}

	/**
	 * 쿠폰 관리 - 목록 : 쿠폰 목록 조회
	 * @param adminAdCouponVO
	 * @return
	 * @throws Exception
	 */
	public List<AdminAdCouponVO> getAdCouponList(AdminAdCouponVO adminAdCouponVO) throws Exception{

		return adminAdCouponMapper.getAdCouponList(adminAdCouponVO);
	}
	
	@Transactional(propagation = Propagation.REQUIRED, rollbackFor = {Exception.class})
	public void couponDelProc(List<AdminAdCouponVO> list) throws Exception {
		String admin_id = SessionUtil.getAdminId();
		
		if(list.size() == 0) {
			throw new Exception( messageSource.getMessage("data.null", null, Locale.KOREA));
		}
		
		for(int i=0; i<list.size(); i++) {
			AdminAdCouponVO adminAdCouponVO = list.get(i);
			adminAdCouponVO.setAdmin_id(admin_id);
			
			adminAdCouponMapper.couponDelProc(adminAdCouponVO);
		}
		
	}

	
	
}
